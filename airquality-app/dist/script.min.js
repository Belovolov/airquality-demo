function aqi18nGetDays(){
	return{
		en:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],cn:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],jp:["月曜日","火曜日","水曜日","木曜日","金曜日","土曜日","日曜日"],es:["lunes","martes","miércoles","jueves","viernes","sábado","domingo"],kr:["월요일","화요일","수요일","목요일","금요일","토요일","일요일"],ru:["понедельник","вторник","среда","четверг","пятница","суббота","воскресенье"],hk:["星期一","星期二","星期三","星期四","星期五","星期六","星期天"],fr:["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"],pl:["Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota","Niedziela"],de:["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],pt:["segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","sexta-feira","Sábado","domingo"],vn:["thứ hai","thứ ba","thứ tư","thứ năm","thứ sáu","thứ bảy","chủ nhật"]
	}

}
function aqi18nGetAqiLevels(){
	return{
		en:[{
			m:"no data",s:"38px"
		}
			,{
				m:"Good",s:"38px"
			}
			,{
				m:"Moderate",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Unhealthy</span><div style='font-size:15px;
				margin-top:-5px;
				'>for Sensitive Groups</div>",s:"38px",n:"Unhealthy for Sensitive Groups"
			}
			,{
				m:"Unhealthy",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Very</div><span style='font-size:30px'>Unhealthy</span>",s:"38px",n:"Very Unhealthy"
			}
			,{
				m:"Hazardous",s:"38px"
			}
		],cn:[{
			m:"<div style='font-size:20px'>没有数据</div>",s:"42px",n:"没有数据"
		}
			,{
				m:"优",s:"42px"
			}
			,{
				m:"良",s:"42px"
			}
			,{
				m:"轻度污染",s:"42px"
			}
			,{
				m:"中度污染",s:"42px"
			}
			,{
				m:"重度污染",s:"42px"
			}
			,{
				m:"严重污染",s:"42px"
			}
		],jp:[{
			m:"データ無し",s:"42px"
		}
			,{
				m:"良い",s:"42px"
			}
			,{
				m:"平常値",s:"42px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>敏感な人には</div><span style='font-size:30px'>良くない状態</span>",s:"42px",n:"敏感な人には良くない状態"
			}
			,{
				m:"<div style='font-size:20px'>健康に良くない</div>",s:"42px",n:"健康に良くない"
			}
			,{
				m:"<div style='font-size:20px'>非常に健康に悪い</div>",s:"42px",n:"非常に健康に悪い"
			}
			,{
				m:"危険",s:"42px"
			}
		],es:[{
			m:"<div style='font-size:20px'>ningún dato</div>",s:"38px",n:"ningún dato"
		}
			,{
				m:"Bueno",s:"38px"
			}
			,{
				m:"Moderado",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Enfermo</span><div style='font-size:15px;
				margin-top:-5px;
				'>para los Grupos Sensibles</div>",s:"38px",n:"Enfermo para los Grupos Sensibles"
			}
			,{
				m:"Enfermo",s:"38px"
			}
			,{
				m:"Muy Enfermo",s:"38px"
			}
			,{
				m:"Arriesgado",s:"38px"
			}
		],kr:[{
			m:"사용할 수 없습니다",s:"42px"
		}
			,{
				m:"좋음",s:"42px"
			}
			,{
				m:"보통",s:"42px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>노약자나 임산부에게</div><span style='font-size:30px'>좋지않음</span>",s:"42px",n:"노약자나 임산부에게 좋지않음"
			}
			,{
				m:"나쁨",s:"42px"
			}
			,{
				m:"매우나쁨",s:"42px"
			}
			,{
				m:"위험",s:"42px"
			}
		],ru:[{
			m:"<div style='font-size:20px'>нет данных</div>",s:"38px",n:"нет данных"
		}
			,{
				m:"Среднее",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Неподходящее</span><div style='font-size:15px;
				margin-top:-5px;
				'>для особо восприимчивых</div>",s:"38px",n:"Неподходящее для особо восприимчивых"
			}
			,{
				m:"Плохое",s:"38px"
			}
			,{
				m:"Нездоровое",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Очень</div><span style='font-size:30px'>нездоровое</span>",s:"38px",n:"Очень нездоровое"
			}
			,{
				m:"Опасное",s:"38px"
			}
		],hk:[{
			m:"<div style='font-size:20px'>沒有數據</div>",s:"42px",n:"沒有數據"
		}
			,{
				m:"優",s:"42px"
			}
			,{
				m:"良",s:"42px"
			}
			,{
				m:"輕度污染",s:"42px"
			}
			,{
				m:"中度污染",s:"42px"
			}
			,{
				m:"重度污染",s:"42px"
			}
			,{
				m:"嚴重污染",s:"42px"
			}
		],fr:[{
			m:"<div style='font-size:20px'>pas de données</div>",s:"38px",n:"pas de données"
		}
			,{
				m:"Bon",s:"38px"
			}
			,{
				m:"Modéré",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Mauvais</span><div style='font-size:15px;
				margin-top:-5px;
				'>pour les groupes sensibles</div>",s:"38px",n:"Mauvais pour les groupes sensibles"
			}
			,{
				m:"Mauvais",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Très</div><span style='font-size:30px'>mauvais</span>",s:"38px",n:"Très mauvais"
			}
			,{
				m:"Dangereux",s:"38px"
			}
		],pl:[{
			m:"<span style='font-size:30px'>Dane</span><div style='font-size:15px;
			margin-top:-5px;
			'>niedostępne</div>",s:"38px",n:"Dane niedostępne"
		}
			,{
				m:"Dobra",s:"38px"
			}
			,{
				m:"Średnia",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Niezdrowa</span><div style='font-size:15px;
				margin-top:-5px;
				'>dla osób wrażliwych</div>",s:"38px",n:"Niezdrowa dla osób wrażliwych"
			}
			,{
				m:"Niezdrowa",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Bardzo</div><span style='font-size:30px'>niezdrowa</span>",s:"38px",n:"Bardzo niezdrowa"
			}
			,{
				m:"<span style='font-size:30px'>Zagrożenie</span><div style='font-size:15px;
				margin-top:-5px;
				'>dla życia</div>",s:"38px",n:"Zagrożenie dla życia"
			}
		],de:[{
			m:"Nicht verfügbar",s:"38px"
		}
			,{
				m:"Gut",s:"38px"
			}
			,{
				m:"Moderat",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Ungesund</span><div style='font-size:15px;
				margin-top:-5px;
				'>für empfindliche Personengruppen</div>",s:"38px",n:"Ungesund für empfindliche Personengruppen"
			}
			,{
				m:"Ungesund",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Sehr</div><span style='font-size:30px'>ungesund</span>",s:"38px",n:"Sehr ungesund"
			}
			,{
				m:"Gefährlich",s:"38px"
			}
		],pt:[{
			m:"Não disponível",s:"38px"
		}
			,{
				m:"Boa",s:"38px"
			}
			,{
				m:"Moderado",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Insalubre</span><div style='font-size:15px;
				margin-top:-5px;
				'>para grupos sensíveis</div>",s:"38px",n:"Insalubre para grupos sensíveis"
			}
			,{
				m:"Insalubre",s:"38px"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>Muito</div><span style='font-size:30px'>Insalubre</span>",s:"38px",n:"Muito Insalubre"
			}
			,{
				m:"Perigoso",s:"38px"
			}
		],vn:[{
			m:"Không có sẵn",s:"38px"
		}
			,{
				m:"tốt",s:"38px"
			}
			,{
				m:"trung bình",s:"38px"
			}
			,{
				m:"<span style='font-size:30px'>Không lành mạnh</span><div style='font-size:15px;
				margin-top:-5px;
				'>cho các nhóm người nhạy cảm</div>",s:"38px",n:"Không lành mạnh cho các nhóm người nhạy cảm"
			}
			,{
				m:"<div style='font-size:20px'>Có hại cho sức khỏe</div>",s:"38px",n:"Có hại cho sức khỏe"
			}
			,{
				m:"<div style='font-size:18px;
				margin-bottom:-5px;
				'>rất</div><span style='font-size:30px'>có hại cho sức khỏe</span>",s:"38px",n:"rất có hại cho sức khỏe"
			}
			,{
				m:"Nguy hiểm",s:"38px"
			}
		]
	}

}
function AirPromise(a){
	this._info=a,this._thens=[]
}
function loadJSON(a){
	function b(){
		for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",b="",c=-1;
			++c<15;
		)b+=a.charAt(Math.floor(52*Math.random()));
		return b
	}
	var c=b(),d=a.match(/callback=\?/);
	d&&d.length?a=a.replace(/callback=\?/,"callback=waqiloader.jsonp."+c):a+="&callback=waqiloader.jsonp."+c;
	var e=new AirPromise("Loading JSON "+a),f=element=document.createElement("script");
	return f.type="text/javascript",f.src=a,waqiloader.jsonp[c]=function(a){
		e.resolve(a),delete waqiloader.jsonp[c],f.remove()
	}
		,element.onload=element.onreadystatechange=function(a){
			element.readyState&&"complete"!==element.readyState
		}
		,element.onerror=function(a){
			e.reject()
		}
		,document.getElementsByTagName("head")[0].appendChild(f),e
}
function loadCss(a){
	var b=document.createElement("link");
	b.type="text/css",b.rel="stylesheet",b.href=a;
	var c=new AirPromise("Loading CSS "+a);
	return b.onload=b.onreadystatechange=function(a){
		b.readyState&&"complete"!==b.readyState||(b.onload=b.onreadystatechange=null,c.resolve())
	}
		,b.onerror=function(a){
			c.reject()
		}
		,document.getElementsByTagName("head")[0].appendChild(b),c
}
function loadScriptAsync(a,b){
	return loadScriptGeneric(a,b,!0)
}
function loadScript(a,b){
	return loadScriptGeneric(a,b,!1)
}
function loadScriptGeneric(a,b,c){
	var d=document.createElement("script");
	d.type="text/javascript",d.async=c,d.src=a;
	var e=b||new AirPromise("Loading script "+a);
	return d.onload=d.onreadystatechange=function(a){
		d.readyState&&"complete"!==d.readyState||(d.onload=d.onreadystatechange=null,e.resolve())
	}
		,d.onerror=function(a){
			e.reject()
		}
		,document.getElementsByTagName("head")[0].appendChild(d),e
}
function fetchJSON(url){
	var p=new AirPromise("Fetch JSON "+url),r=new XMLHttpRequest;
	url.indexOf("?")<0&&(url+="?");
	try{
		url+="&k="+jskey()
	}
	catch(e){

	}
	return url+="&_="+(new Date).getTime(),r.onerror=function(){
		loge("Can not load "+url),p.reject()
	}
		,r.open("GET",url,!0),r.onreadystatechange=function(){
			if(4==r.readyState&&200==r.status){
				var sjson=r.responseText;
				if(null==sjson||0==sjson.length)return p.resolve(null);
				var s="("+sjson+")";
				try{
					json=eval(s)
				}
				catch(e){
					return log("Can not eval JSON",s),void p.reject("Wrong JSON")
				}
				p.resolve(json)
			}

		}
		,r.async=!0,r.send(""),p
}
function loadDirectJSON(url,args,callback){
	var r=new XMLHttpRequest;
	r.open("GET",url+"?"+args,!0),r.onreadystatechange=function(){
		4==r.readyState&&200==r.status&&(eval("var json = "+r.responseText+";
			"),callback(json))
		}
		,r.send("")
}
function AqiGraphFactory(a){
	this.model=a,this.init()
}
function resize(){
	isResizing=!0;
	try{
		resizeText(),resizeImage()
	}
	catch(a){
		log("Resizing Error "+a),console&&console.log(a)
	}
	isResizing=!1
}
function resizeText(){

}
function ssh(a){
	return 10>a?10:a
}
function ssw(a){
	return 150>a?150:300>a?a-a%10:500>a?a-a%20:800>a?a-a%35:a-a%50
}
function resizeImage(){
	function a(a,b,c,e,f,g,h){
		"undefined"==typeof imgLoaderDelay[d]?imgLoaderDelay[d]=setTimeout(function(){
			D(a,b,c,e,f,g)
		}
			,h):(clearTimeout(imgLoaderDelay[d]),imgLoaderDelay[d]=setTimeout(function(){
				D(a,b,c,e,f,g)
			}
				,10))
	}
	if(6>postponneidx&&0==document.getElementById("waHdrMain").clientHeight)return postponneidx++,void setTimeout(function(){
		resizeImage()
	}
		,500);
	postponneidx=0;
	for(var b=getMetrics(),c=b.length,d=0;
		c>d;
		d++)show("min_"+b[d]),show("max_"+b[d]);
	show("min_hdr"),show("max_hdr");
	var e=document.getElementById("table");
	if(null!=e&&null!=e.rows){
		for(var d=0;
			c>d;
			d++)hide("img_"+b[d]);
		for(var f=[],d=0;
			5>d;
			d++)f[d]=0;
		for(var g=0;
			g<e.rows.length;
			g++){
			var h=e.rows[g].cells.length;
			if(h>1)for(var d=0;
				h>d;
				d++){
				var i=e.rows[g].cells[d].clientWidth;
				f[d]=Math.max(f[d],i+2)
			}

		}
		for(var j=getWindowWidth()-f[0]-f[1]-f[3]-f[4]-5,d=0;
			c>d;
			d++)show("img_"+b[d]);
		var k=45,l=600>j?2:5,m=[1,2,2,2,3,3,4,4,4];
		document.getElementById("evolution").innerHTML=getTextNDays(m[l]-1);
		for(var n=" window-height="+getWindowHeight()+" doc-height="+getDocHeight(),o=j>300,d=0;
			c>d;
			d++){
			var p=document.getElementById("tr_"+b[d]);
			p.style.display="none",o?show("min_"+b[d]):hide("min_"+b[d]),o?show("max_"+b[d]):hide("max_"+b[d])
		}
		o?(show("min_hdr"),show("max_hdr")):(hide("min_hdr"),hide("max_hdr"));
		var j=getWindowWidth()-f[0]-f[1]-18;
		n+=" w="+getWindowWidth()+" cols={
		"+f[0]+","+f[1]+"
	}
		",o&&(j-=f[3]+f[4]);
		var q=function(a){
			return document.getElementById(a).clientHeight
		}
			,r=q("header")+2,s=q("waHdrMain")+2,t=q("tr_header")+2;
		n+=" [header:"+r+" wahdr:"+s+" trhdr:"+t+"]";
		var u=r+s+(0!=t?t:40)+8;
		try{
			var v=adSenseExtraHeight();
			n+=" [ad-height:"+v+"]",u+=v
		}
		catch(p){

		}
		var w=0;
		document.getElementById("tr_weather_header")&&(w=q("tr_weather_header")+2);
		var x=getWindowHeight()-u-w;
		n+=" [#rows:"+c+"] [height:"+x+"]";
		var k=Math.floor(x/c);
		k=Math.max(25,k);
		var y=document.getElementById("img_"+b[d]);
		if(y&&y.src&&currentsize==j+"x"+k){
			for(var d=0;
				c>d;
				d++)document.getElementById("tr_"+b[d]).style.display="";
			return void(isResizing=!1)
		}
		currentsize=j+"x"+k;
		var z=null;
		try{
			z=new AqiGraphFactory(getAqiModel())
		}
		catch(p){
			log("error:"+p)
		}
		for(var d=0;
			c>d;
			d++){
			var A=0==d||"t"==b[d],B=document.getElementById("img_"+b[d]),C=k+(A?8:0)-6;
			B.height=C,B.width=j;
			var D=function(a,b,c,d,e,f){
				try{
					var g=z.getGraph(d,e,a,f);
					b.src=g.src
				}
				catch(h){
					log("error:"+h);
					var g=document.createElement("img");
					g.src=c,addListener(g,"load",function(a){
						b.src=c
					}
					)
				}

			}
				,E=getImageUrl(),F=A?"_hdr":"",G=["t","d","p","h","w","r"].indexOf(b[d])>=0?"weather":"waqi";
			E+=G+"_"+b[d]+"_"+ssw(j)+"_"+ssh(k)+"_"+l+F+".png";
			var H=new Date;
			E+="?t="+H.getTime(),a(b[d],B,E,j,C,A,50*(d+1))
		}
		for(var d=0;
			c>d;
			d++)show("tr_"+b[d]);
		isResizing=!1
	}

}
function resizer(){
	isResizing||resize()
}
function initResizer(){
	isVisible("waPageMain")&&(window.addEventListener?addEventListener("resize",resizer,!1):attachEvent("resize",resizer))
}
function ld(a,b){
	if(window.navigator.standalone)if(b){
		var c=document.createElement("a");
		c.setAttribute("href",a),c.setAttribute("target","_blank");
		var d=document.createEvent("HTMLEvents");
		d.initEvent("click",!0,!0),c.dispatchEvent(d)
	}
	else window.open(a);
	else location.href=a
}
function lds(a,b){
	var c=document.createElement("script");
	c.src=a+"&jsoncallback="+b,document.getElementsByTagName("head")[0].appendChild(c)
}
function html(a,b){
	try{
		document.getElementById(a).innerHTML=b
	}
	catch(c){

	}

}
function hide(a){
	try{
		document.getElementById(a).style.display="none"
	}
	catch(b){

	}

}
function show(a){
	try{
		document.getElementById(a).style.display=""
	}
	catch(b){

	}

}
function isVisible(a){
	try{
		return"none"!=document.getElementById(a).style.display
	}
	catch(b){
		return!1
	}

}
function scrollPageCss(a,b,c){
	var d={

	}
		,e={
			vendor:function(){
				var a,b=document.createElement("div"),c="webkit Moz O ms".split(" ");
				for(a in c)if("undefined"!=typeof b.style[c[a]+"Transition"])return c[a]
			}
			,transitionCallback:function(){
				return"Moz"===d.vendor||"ms"===d.vendor?"transitionend":d.vendor+"TransitionEnd"
			}
			,canTransform:function(a){
				return"undefined"!=typeof a.style[d.vendor+"Transform"]
			}

		}
	;
	d.vendor=e.vendor();
	var f={
		slidein:function(a,b){
			if(this.objIn=a,this.objOut=b,e.canTransform(a)){
				var c=(window.innerWidth||document.documentElement.clientWidth)+"px";
				a.className="waPage",this.objIn.style[d.vendor+"Transform"]="translate3d("+c+", 0,0)",this.objIn.style[d.vendor+"Transition"]="all 0s ease",this.timer=setTimeout(function(){
					f.callback()
				}
					,1)
			}
			else a.className="waPage",b.className="waPage waPageHidden"
		}
		,slideout:function(a,b){
			if(this.objIn=a,this.objOut=b,e.canTransform(a)){
				var c=(window.innerWidth||document.documentElement.clientWidth)+"px";
				a.className="waPage",this.objOut.style[d.vendor+"Transform"]="translate3d("+c+", 0,0)",this.objOut.style[d.vendor+"Transition"]="all 0.3s ease",setTimeout(function(){
					f.objOut.className="waPage waPageHidden"
				}
					,300)
			}
			else a.className="waPage",b.className="waPage waPageHidden"
		}
		,callback:function(){
			this.objIn.style[d.vendor+"Transform"]="translate3d(0, 0,0)",this.objIn.style[d.vendor+"Transition"]="all 0.3s ease",setTimeout(function(){
				f.objOut.className="waPage waPageHidden"
			}
				,300)
		}

	}
	;
	c==SCROLLMODE.PUSH?f.slidein(document.getElementById(a),document.getElementById(b)):c==SCROLLMODE.POP&&f.slideout(document.getElementById(a),document.getElementById(b))
}
function onBtnMouseOver(a){
	a||(a=window.event);
	for(var b=a.target?a.target:a.srcElement;
		""==b.id;
	)b=b.parentNode;
	b.backgroundColor=b.style.backgroundColor,b.style.backgroundColor="white"
}
function onBtnMouseOut(a){
	a||(a=window.event);
	for(var b=a.target?a.target:a.srcElement;
		""==b.id;
	)b=b.parentNode;
	b.style.backgroundColor=b.backgroundColor||""
}
function onBtnTouchStart(a){
	return
}
function onBtnTouchEnd(a){
	return
}
function onBtnClick(a){
	if(!isTouchEnabled){
		a||(a=window.event);
		for(var b=a.target?a.target:a.srcElement;
			""==b.id;
		)b=b.parentNode;
		b.style.backgroundColor="#ccf",onBtnAction(b,b.id)
	}

}
function getWindowHeight(){
	var a=0;
	return"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight),a
}
function getWindowWidth(){
	var a=0;
	return"number"==typeof window.innerWidth?a=window.innerWidth:document.documentElement&&document.documentElement.clientWidth?a=document.documentElement.clientWidth:document.body&&document.body.clientWidth&&(a=document.body.clientWidth),a
}
function getDocHeight(){
	var a=document;
	return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))
}
function addListener(a,b,c,d){
	return d=d||!1,window.addEventListener?(a.addEventListener(b,c,d),!0):window.attachEvent?(a.attachEvent("on"+b,c),!0):!1
}
function initButtons(){
	for(var a=document.getElementsByTagName("*"),b=0;
		b<a.length;
		b++)try{
			var c=a[b].className;
			-1!=c.indexOf("wgtBtn")&&(addListener(a[b],"click",onBtnClick),addListener(a[b],"mouseover",onBtnMouseOver),addListener(a[b],"mouseout",onBtnMouseOut),addListener(a[b],"touchstart",onBtnTouchStart),addListener(a[b],"touchend",onBtnTouchEnd))
		}
	catch(d){

	}

}
function initOptionMenu(){
	snapper=new Snap({
		element:document.getElementById("waPageMain"),maxPosition:200,minPosition:-200
	}
	)
}
function isOptionMenuOpened(){
	return snapper&&"closed"!=snapper.state().state
}
function closeOptionMenu(){
	isOptionMenuOpened()&&snapper.close()
}
function toggleLeftOptionMenu(){
	isOptionMenuOpened()?snapper.close():snapper.open("left")
}
function toggleRightOptionMenu(){
	isOptionMenuOpened()?snapper.close():snapper.open("right")
}
function onClickMainGraphPage(a){
	if(snapper.isdragging())return void log("onClickMainGraphPage - skip since drag done");
	if(log("onClickMainGraphPage"),isOptionMenuOpened())closeOptionMenu();
	else try{
		var b=a.pageX,c=window.innerWidth||document.documentElement.clientWidth;
		c/3>b?toggleLeftOptionMenu():2*c/3>b?showWindForecast():toggleRightOptionMenu()
	}
	catch(a){
		showWindForecast()
	}

}
function searchAqiBgColor(a){
	return"-"==a?"#aaaaaa":50>=a?"#009966":100>=a?"#ffde33":150>=a?"#ff9933":200>=a?"#cc0033":300>=a?"#660099":"#7e0023"
}
function searchAqiFgColor(a){
	return"-"==a?"#eeeeee":50>=a?"#ffffff":100>=a?"#000000":150>=a?"#000000":"#ffffff"
}
function onNavigateToCitySelection(){
	"undefined"!=typeof getSvgFlagsPath&&loadCss(getSvgFlagsPath()),setTimeout(function(){
		var a=document.getElementById("citysearch");
		a.focus()
	}
		,250)
}
function citySearch(a){
	hide(a),show("citysearch"),document.getElementById("citysearch").focus()
}
function citySearchKeyUp(){
	var a=document.getElementById("citysearch").value;
	""!=a&&null!=a&&(show("citySearchLoadingIndi"),aqisrv.search.station(a).then(function(a){
		hide("citySearchLoadingIndi"),html("searchresults",citySearchFormatData(a))
	}
	))
}
function cityAutoLocate(a){
	document.getElementById("autoLocateLoadingIndi").style.display="inline-block",show("autolocateresults"),html("autolocatecityresults",""),hide(a),aqisrv.nearest.ip().then(function(a){
		try{
			hide("autoLocateLoadingIndi"),show("autolocateresults");
			var b=citySearchFormatData(a);
			html("autolocatecityresults",b)
		}
		catch(c){
			log(c)
		}

	}
	)
}
function citySearchFormatData(a){
	for(var b="",c=0;
		c<a.results.length;
		c++){
		var d=a.results[c],e="";
		if(d.x&&(e="/city/@"+d.x+"/"),d.s&&d.s.u&&(e="/city/"+d.s.u+"/"),"en"!=getLang()&&(e+=getLang()+"/"),e+="m/",b+="<div class='wgtBtn wgtBtnUrl' ",""!=e&&(b+="href='"+e+"' "),b+="id='wgtBtnCitySearch"+c+"' ",b+="wgturl='"+e+"' ",b+="onclick='onBtnClick( event );
			' ",b+="onmouseover='onBtnMouseOver( event );
			' ",b+="onmouseout='onBtnMouseOut( event );
			' ",b+="ontouchstart='onBtnTouchStart( event );
			' ",b+="ontouchend='onBtnTouchEnd( event );
			'>",d.c&&(flag="<div class='sprite-ispritflags sprite-ispritflags-"+d.c.toLowerCase()+"' style='display:inline-block;
			vertical-align:middle;
			margin:0 2px;
			min-width:24px;
			'></div>",b+=flag),d.s){
			var f=searchAqiBgColor(d.s.a),g=searchAqiFgColor(d.s.a);
			b+="<div class='citysearchaqitag' style='background-color:"+f+";
			color:"+g+"'>"+d.s.a+"</div>"
		}
	name=d.n.join(";
		"),1==d.n.length&&d.s&&d.s.n.length>1&&(name=d.s.n.join(";
		")),b+=name,b+="</div>"
	}
return b
}
function citySearchFormatDataLarge(a,b){
	b=b||"";
	var c="http://aqicn.org/?size=xlarge&";
	"en"!=getLang()&&(c+="lang="+getLang()+"&"),c+="city=";
	for(var d="",e=0;
		e<a.length;
		e++){
		var f=a[e],g=c+f.id;
		f.vtime&&!f.utime&&(f.utime=aqi18n.getDateTime(new Date(1e3*f.vtime))),"undefined"!=typeof f.curl&&(g=f.curl);
		var h=searchAqiBgColor(f.aqi),i=searchAqiFgColor(f.aqi),j=f.aqi;
		d+="<div class='wgtBtn wgtBtnNearest' ",d+="id='wgtBtnCitySearch"+e+"' ",d+="wgturl='"+g+"' ",d+="onclick='onBtnClick( event );
		' ",d+="onmouseover='onBtnMouseOver( event );
		' ",d+="onmouseout='onBtnMouseOut( event );
		' ",d+="ontouchstart='onBtnTouchStart( event );
		' ",d+="ontouchend='onBtnTouchEnd( event );
		'>",d+="<table><tr><td>",d+="<span class='citysearchaqitag' style='text-shadow:0 0 0;
		font-size:21px;
		padding-top:8px;
		height:100%;
		background-color:"+h+";
		color:"+i+"'>"+j+"</span>",d+="</td><td style='font-size:15px;
		'><div style='"+b+";
		height:18px;
		overflow:hidden;
		white-space: nowrap;
		text-overflow:ellipsis;
		'>"+f.name+"</div>",f.utime&&(d+="<small style='color:#888;
		'>("+f.utime+")"),d+="<//td></tr></table>",d+="</div>"
	}
	return d
}
function gotoLocatePage(){
	waNav.push("Locate"),getLocation()
}
function getLocation(){
	var a=!1,b=!1,c=function(a){
		log("Geolocation error!"),d()
	}
		,d=function(c){
			try{
				if(a||b)return;
				a=!0,aqisrv.nearest.ip().then(function(a){
					onUserGeolocationGetCities(a)
				}
				)
			}
			catch(d){
				log("getViaIP - "+d)
			}

		}
		,e=function(a){
			try{
				b=!0,log("Localization obtained");
				var c=a.coords.latitude,d=a.coords.longitude;
				aqisrv.nearest.geo(c,d).then(function(a){
					onUserGeolocationGetCities(a)
				}
				)
			}
			catch(e){
				log("getViaLoc error "+e)
			}

		}
	;
	navigator.geolocation?(log("Starting the geolocalization"),navigator.geolocation.getCurrentPosition(e,c,{
		timeout:2e4
	}
	),setTimeout(function(){
		d()
	}
		,5e3)):d()
}
function onUserGeolocationGetCities(a){
	try{
		hide("geolocquery"),show("geolocresults"),html("geoloctitle","");
		var b=[];
		a.d.forEach(function(a){
			b.push({
				n:[a.nlo,a.nna],s:{
					a:a.v
				}
				,x:a.x
			}
			)
		}
		),log(b);
		var c=citySearchFormatData({
			results:b
		}
		);
		html("geolocresults",c)
	}
	catch(d){
		log("onUserGeolocationGetCities error "+d)
	}

}
function saveHistory(a){
	try{
		a.time=(new Date).toISOString(),Cookies&&Cookies.set("waqi-m-station",JSON.stringify(a),{
			expires:30
		}
		);
		var b=[a],c=[];
		try{
			c=JSON.parse(Cookies.get("waqi-m-history"))
		}
		catch(d){

		}
		c.forEach(function(c){
			c.id!=a.id&&b.push(c)
		}
		),Cookies&&Cookies.set("waqi-m-history",JSON.stringify(b.slice(0,4)))
	}
	catch(d){
		log("error",d)
	}

}
function showHistory(a){
	try{
		var b="",c=JSON.parse(Cookies.get("waqi-m-history"));
		c.forEach(function(c,d){
			if(0!=d){
				var e=a+"-"+c.id.replace("@","");
				b+="<div class='wgtBtn wgtBtnSnap' wgturl='"+c.url+"' style='display:none;
				text-align:left;
				' id='"+e+"'></div>",aqisrv.now(c.id).then(function(a){
				var b=(getAqiLevel(a.aqi),"");
				b+="<table><tr><td style='font-size: 200%;
				width: 80px;
				text-align: center;
				'>"+a.aqi+"</div>",b+="<td>",b+="<span style='font-size:120%'>"+c.name+"</span>",b+="<div style='font-size:80%;
				'>"+a.time.s+"</div>",b+="</table>",$O(e,b,{
				backgroundColor:aqiColor(a.aqi,"b"),color:aqiColor(a.aqi,"f"),textShadow:"1px 0px 1px "+aqiColor(a.aqi,"s"),display:"block"
			}
		)
		}
	)
	}

}
								),$O(a,b)
}
catch(d){
	log(d)
}

}
function $O(a,b,c,d){
	try{
		var e=document.getElementById(a);
		if(b&&(e.innerHTML=b),c)for(x in c)e.style[x]=c[x];
		if(d)for(x in c)e[x]=d[x];
		return e
	}
	catch(f){
		log("Failed to generate "+a,f)
	}

}
function $G(a){
	generators.push(a),a(getAqiModel())
}
function $RG(){
	generators.forEach(function(a){
		a(getAqiModel())
	}
	)
}
function randomizeAQI(a){
	var b=getAqiModel();
	b.aqi=a||Math.round(500*Math.random())
}
function getMetrics(){
	var a=getAqiModel().iaqi.map(function(a){
		return a.p
	}
	);
	return a
}
function getAqiLevel(a){
	var b=aqi18nGetAqiLevels(),c=getLang();
	return b=c in b?b[c]:b.en,0>a||!isNumeric(a)?b[0]:50>a?b[1]:100>a?b[2]:150>a?b[3]:200>a?b[4]:300>a?b[5]:b[6]
}
function getAqiTable(a){
	var b="<tr id='tr_header' ><td nowrap=true><span class='item'></span></td><td align=center class='tdcur' nowrap=true><span class='item'>"+i18nGetString("current")+"</span></td><td style='color:#888;
	font-size:11px;
	' id='td_header' class='tdnfo'><center><span id='evolution' class='item' ></span></center></td><td style='display:none;
	' align=center id='min_hdr' class='tdmax' nowrap=true><span class='item'>"+i18nGetString("min")+"</span></td><td style='display:none;
	' align=center id='max_hdr' class='tdmin' nowrap=true><span class='item'>"+i18nGetString("max")+"</span></td></tr>";
	return a.iaqi.forEach(function(a,c){
		var d=1&c?"#edf6fb":"",e=0==c||"t"==a.p?"class='delimited'":"";
		"t"==a.p&&2>=c&&(b+="<tr id='tr_weather_header' class='delimited' ><td nowrap=true><span class='item'></span></td><td align=center class='tdcur' nowrap=true><span class='item'>"+i18nGetString("current")+"</span></td><td style='color:#888;
			font-size:11px;
			' class='tdnfo'><center>"+i18nGetString("weather")+"</center></td><td align=center id='min_hdr' class='tdmax' nowrap=true></td><td align=center id='max_hdr' class='tdmin' nowrap=true></td></tr>"),b+="<tr "+e+" id='tr_"+a.p+"' style='background-color:"+d+"' title='"+a.i+"'>",b+="<td id='hdr_"+a.p+"' nowrap style='font-size:15px;
			max-width:38px;
			overflow:hidden;
			'>"+getMetricName(a.p)+"</td>",b+="<td id='cur_"+a.p+"' class='tdcur' align=center>"+aqiColorize(a.v[0],a.p)+"</td>",b+="<td id='td_"+a.p+"' style='width:100%;
			'  align=center><img id='img_"+a.p+"'/></td>",b+="<td id='min_"+a.p+"' class='tdmin' style='display:none;
			' align=center>"+aqiColorize(a.v[1],a.p)+"</td>",b+="<td id='max_"+a.p+"' class='tdmax' style='display:none;
			' align=center>"+aqiColorize(a.v[2],a.p)+"</td>"
		}
		),b
}
function showAqiForecast(a,b,c){
	b&&show(b);
	var d="",e="",f="",g=0,h="<div style='overflow-x:scroll;
	max-width:100%;
	'><table cellpadding=0 cellspacing=0 style='border:0px solid black;
	padding:3px;
	text-align:center'>",i=getWindowWidth(),j=Math.max(18,Math.min(25,Math.round(i/24)-1)),k=j-2,l=5,m=0,n=null,o=null,p=new Date,g=a.forecast.length;
	return a.forecast.forEach(function(a,b){
		if(!(null==a||l+j>i)){
			if(a.t){
				var c=new Date(a.t),h=(p-c)/36e5;
				if(h>6&&g-b>i/j+8)return;
				a.dn=aqi18n.getDate(c),a.d=c.getDay(),a.h=c.getHours()
			}
			else l+=j;
			a.dn+" "+a.h+":00\nAQI: "+a.v[0]+" -> "+a.v[1];
			a.c=[aqiForecastColor(a.v[0]),aqiForecastColor(a.v[1])];
			var q="";
			if(q+=a.c[0]==a.c[1]?'<svg height="'+k+'" width="'+k+'" ><polygon points="0,0 '+k+",0 "+k+","+k+" 0,"+k+'" style="fill:'+a.c[0]+';
				" /></svg>':'<svg height="'+k+'" width="'+k+'" ><polygon points="0,0 '+k+",0 0,"+k+'" style="fill:'+a.c[0]+';
				" /><polygon points="'+k+",0 "+k+","+k+" 0,"+k+'" style="fill:'+a.c[1]+';
				" /></svg>',a.d!=n&&m){
				var r="<td style='border-left:1px solid black;
				margin-left:1px'>";
				d+=r,e+=r,f+="<td colspan="+m+" >",m>4&&(f+=o.dn),f+=r,m=0
			}
		d+="<td style='padding-left:1px;
		'>"+q,e+="<td>"+parseInt(a.h||"-"),n=a.d,m++,o=a
	}

}
									),h+="<tr>"+d,h+="<tr style='font-size:9px;
		'>"+e,h+="<tr style='font-size:12px;
		color:#bbbbbb;
		'>"+f,h+="</table></div>",c&&html(c,"<center>"+h+"</center>"),"<center>"+h+"</center>"
	}
function isNumeric(a){
	return!isNaN(parseFloat(a))&&isFinite(a)
}
function colorMixer(a,b,c){
	for(var d="#",e=0;
		3>e;
		e++){
		var f=parseInt(a.substr(1+2*e,2),16),g=parseInt(b.substr(1+2*e,2),16),h=Math.round(f+(g-f)*c);
		h=Math.min(255,Math.max(0,h)),h=h.toString(16),1==h.length&&(h="0"+h),d+=h
	}
	return d
}
function colorRangeMixer(a,b){
	var c=b.c.length,d=b.f,e=d+c*b.s;
	if(d>=a)return b.c[0];
	if(a>=e-b.s)return b.c[c-1];
	a-=d;
	var f=Math.floor(a/b.s),g=(a-f*b.s)/b.s;
	f>=c-1&&(f=c-2);
	var h=colorMixer(b.c[f],b.c[f+1],g);
	return h
}
function aqiColor(a,b,c){
	if("ts"==b)return aqiColor(a,"f",c);
	if("s"==b)return"#ffffff"==aqiColor(a,"f",c)?"#000000":"#ffffff";
	"d"==c&&(c="t");
	var d={
		t:{
			f:-20,s:10,c:["#022887","#326DE1","#80A7FD","#A4EE27","#FEEC00","#FFBA01","#FF7A01","#F62304","#C40305","#8D0000"]
		}
		,h:{
			f:0,s:100,c:["#FEEC00","#326DE1"]
		}
		,w:{
			f:0,s:10,c:["#FFFFFF","#326DE1","#a0bbf1"]
		}
		,p:{
			f:980,s:5,c:["#0000CC","#0066CC","#0099CC","#00CCFF","#00FFCC","#00FF99","#00FF99","#FFFF66","#FFCC00","#FF9933","#FF6600","#FF3300","#CC3300"]
		}

	}
	;
	if(c in d)return"f"==b?"#ffffff":colorRangeMixer(a,d[c]);
	if("uvi"==c)return"f"==b?"#ffffff":2>=a?"#289500":5>=a?"#F7E400":7>=a?"#F85900":10>=a?"#D8001D":"#6B49C8";
	if(!isNumeric(a)||0>=a)return"b"==b?"#cccccc":"#000000";
	var e=[{
		a:50,b:"#009966",f:"#ffffff"
	}
		,{
			a:100,b:"#ffde33",f:"#000000"
		}
		,{
			a:150,b:"#ff9933",f:"#000000"
		}
		,{
			a:200,b:"#cc0033",f:"#ffffff"
		}
		,{
			a:300,b:"#660099",f:"#ffffff"
		}
		,{
			b:"#7e0023",f:"#ffffff"
		}
	];
	for(i in e){
		var f=e[i];
		if(a<=f.a||void 0==f.a)return f[b]
	}

}
function aqiHistoricalColor(a){
	var b=["#009966","#ffde33","#ff9933","#cc0033","#660099","#7e0023"];
	if(0>a||!isNumeric(a))return"#ffffff";
	if(25>=a)return colorMixer("#ffffff",b[0],.66);
	for(var c=50,d=0;
		200>c;
		c+=50,d++){
		if(c>=a)return b[d];
		if(c+25>=a)return colorMixer(b[d],b[d+1],.5)
	}
	return aqiColor(a,"b")
}
function aqiForecastColor(a,b){
	return 0>a?"#888888":50>a?colorMixer("#009966","#ffde33",a/50):100>a?colorMixer("#ffde33","#ff9933",(a-50)/50):b&&a>150&&200>a?colorMixer("#cc0033","#660099",(a-150)/50):aqiColor(a,"b")
}
function aqiColorize(a,b,c){
	c=c||"";
	var d=aqiColor(a,"f",b),e=aqiColor(a,"b",b),f=aqiColor(a,"s",b);
	c+=";
	color:"+d+";
	background-color:"+e+";
	text-shadow: 1px 0px 1px "+f+";
	";
	var g=!isNaN(parseFloat(a))&&isFinite(a)?Math.round(a):a;
	return("t"==b||"d"==b)&&(g="<span class='temp' format='nu' temp='"+a+"'>"+g+"</span>"),"<div class='saqi item' style='"+c+";
	'>"+g+"</div>"
}
function getForecastView(a){
	function b(a,b){
		a=2*a/3;
		var c=a/2,d=4,e="transform='rotate("+b+","+c+","+c+")'",f="<line stroke='#888' "+e+" x1="+c+" y1=0 x2="+c+" y2="+a+" stroke='#444' stroke-width=1.5></line>";
		f+="<line "+e+" x1="+c+" y1="+a+" x2="+(c-d/2)+" y2="+(a-d)+" stroke='#444' stroke-width=1></line>",f+="<line "+e+" x1="+c+" y1="+a+" x2="+(c+d/2)+" y2="+(a-d)+" stroke='#444' stroke-width=1></line>";
		var g="<svg  style='margin:0px;
		padding:0px;
		' height="+a+" width="+a+">"+f+"</svg>";
		return g
	}
	function c(a,b){
		return 15>a?colorMixer("#b3cde0","#80A7FD",a/15):colorMixer("#80A7FD","#FF7A01",(a-15)/15)
	}
	function d(a,b,d){
		if(0==b.length)return"";
		var e=a,f=a,g=0,h="",i=0,j=(e-b.length*i)/b.length,k=0;
		return b.forEach(function(a,b){
			var e=(i+j)*b,l=a.ws,m=a.wg;
			k+=l;
			var n=f-12,o=c(l,0),p=(l-g)*n/(d-g)+12;
			if(h+="<rect x="+e+" y="+(f-p)+" width="+j+" height="+p+' style="fill:'+o+';
				" />',l!=m){
				var q=c(m,1),r=(m-l)*n/d;
				h+="<rect x="+e+" y="+(f-r-p)+" width="+j+" height="+r+' style="fill:'+q+';
				" />'
			}

	}
			),k=Math.round(k/b.length),h+='<text font-family="sans-serif" font-size=12 x='+e/2+" y="+(f-2)+' text-anchor="middle" fill="black">'+k+"</text>","<svg height="+f+" width="+e+' style="margin:0 0 3px 0">'+h+"</svg>"
}
function e(a,c){
	function e(a,b){
		return a.c=[aqiForecastColor(a.v[0]),aqiForecastColor(a.v[1])],a.c[0]==a.c[1]?'<svg height="'+b+'" width="'+b+'"><polygon points="0,0 '+b+",0 "+b+","+b+" 0,"+b+'" style="fill:'+a.c[0]+';
		" /></svg>':'<svg height="'+b+'" width="'+b+'"><polygon points="0,0 '+b+",0 0,"+b+'" style="fill:'+a.c[0]+';
		" /><polygon points="'+b+",0 "+b+","+b+" 0,"+b+'" style="fill:'+a.c[1]+';
		" /></svg>'
	}
	c&&c.forEach(function(a){
		a.date=new Date(a.t)
	}
	);
	var f=c&&c.length,g=null,h=0;
	a.forEach(function(a){
		for(a.wind=[],a.date=new Date(a.t);
			f>h&&c[h].date<a.date;
		){
			if(g){
				var b=c[h];
				g.wind.push({
					ws:b.w[0],wg:b.w[1],wd:b.w[2],t:b.c
				}
				)
			}
			h++
		}
		g=a
	}
	);
	var i=getWindowWidth(),j=[],k=!0,l=((new Date).getTime(),0);
	if(a.forEach(function(a){
		var b=a.date,c=aqi18n.getDate(b);
		a.wind.forEach(function(a){
			l=Math.max(l,a.wg)
		}
		),(k||c!=pday)&&(j.push({
			values:[],datetime:c
		}
		),pday=c,k=!1),a.hour=b.getHours(),j[j.length-1].values.push(a)
	}
	),0!=j.length){
		content="";
		var m=0,n=(i-80)/16,o=8*n*2,p=Math.floor(Math.min(25,n)),q=document.getElementById("xtradbginfo");
		return q&&(q.innerHTML="[ww="+i+" s="+p+" s1="+n+"]"),j.forEach(function(a,f){
			var g=a.values.length;
			if(!(0==f&&2>g)){
				var h="";
				content+="<table class='forecast-city-table' style='"+h+"'>";
				var k=maxt=0,n=!1;
				a.values.forEach(function(a,b){
					a.wind.forEach(function(a){
						(!n||a.t>maxt)&&(maxt=a.t),(!n||a.t<k)&&(k=a.t),n=!0
					}
					)
				}
				);
				var q="-";
				g>3&&(q=a.datetime,n&&(k=Math.round(k),maxt=Math.round(maxt),q+=" <span style='color:#888;
					font-size:80%;
					'>("+k+"~"+maxt+"&deg;
					C)</span>")),content+="<tr class='day'><td colspan="+g+">"+q,content+="<tr class='hour'>",a.values.forEach(function(a){
					content+="<td>"+a.hour
				}
				),content+="<tr>",a.values.forEach(function(a){
					content+="<td>"+e(a,p)
				}
				),content+="<tr class='aqi'>",a.values.forEach(function(a){
					a.v[0]<0&&a.v[1]<0?content+="<td style=''>n/a<br>-":content+="<td style='font-size:8px;
					line-heigth:1.1;
					'>"+a.v[0]+"<br>"+a.v[1]
				}
				),c&&(content+="<tr class='cwind'>",a.values.forEach(function(a){
					content+="<td>",content+=d(p,a.wind,l)
				}
				),content+="<tr class='cwind'>",a.values.forEach(function(a){
					content+="<td>",a.wind.length&&(content+=b(p,a.wind[0].wd))
				}
				)),content+="</table>",m++,3*o>i?1&m&&(content+="<div class='forecast-separator'></div>"):4==m&&j.length>5?content+="<div class='forecast-linebreak forecast-separator'></div>":content+="<div class='forecast-separator'></div>"
		}

	}
		),content="<div style='overflow-x:hidden;
		max-width:100%;
		' class='forecast-city-block'><center>"+content+"</center></div>",content
	}

}
function f(a){
	var c=(getWindowWidth(),[]),e=!0,f=((new Date).getTime(),0);
	if(a.forEach(function(a){
		var b=new Date(a.t),d=aqi18n.getDateTime(b);
		if(e||d!=pday){
			var g=aqi18n.getDateTime(b);
			c.push({
				values:[],day:g
			}
			),pday=d,e=!1
		}
		a.hour=b.getHours(),c[c.length-1].values.push(a),f=Math.max(f,a.w[1])
	}
	),0!=c.length){
		content="";
		var g=0;
		return c.forEach(function(a,e){
			var h=a.values.length;
			if(!(0==e&&2>h)){
				var i="";
				content+="<table class='forecast-city-table' style='"+i+"'>",content+="<tr class='day'><td colspan="+h+">",
					h>3?content+=a.day:content+=".",content+="<tr class='hour'>",a.values.forEach(function(a){
						content+="<td>"+a.hour
					}
					),content+="<tr class='cwind'>";
				var j=Math.min(18,Math.floor((getWindowWidth()-50)/24));
				a.values.forEach(function(a){
					content+="<td>",content+=d(j,a.w[0],a.w[1],f)
				}
				),content+="<tr class='cwind'>";
				var j=Math.min(18,Math.floor((getWindowWidth()-50)/24));
				a.values.forEach(function(a){
					content+="<td>",content+=b(j,a.w[2])
				}
				),content+="</table>",g++,4==g&&c.length>5?content+="<div class='forecast-linebreak forecast-separator'></div>":content+="<div class='forecast-separator'></div>"
			}

		}
		),"<center>"+content+"</center>"
	}

}
var g=a.forecast,h=null,i=null;
if(g.aqi&&g.aqi.length?(h=e(g.aqi,g.wind),i="aqi"):(h=f(g.wind),i="wind"),a.city){
	var j=a.city.name;
	a.city.idx&&aqi18n.get("city-"+a.city.idx)&&(j=aqi18n.get("city-"+a.city.idx));
	var k=aqi18n.get("CITY_AQIFORECAST_TITLE",{
		__CITY__:"<a>"+j+"</a>"
	}
	);
	k&&(h="<div class='forecast-cityheader'>"+k+"</div>"+h)
}
return{
	view:h,type:i
}

}
function renderCityForecast(a,b){
	function c(a){
		return 15>a?colorMixer("#b3cde0","#80A7FD",a/15):colorMixer("#80A7FD","#FF7A01",(a-15)/15)
	}
	function d(a,b){
		var c=2*a/3,d=c/2,e=4,f="transform='rotate("+b+","+d+","+d+")'",g="<line "+f+" x1="+d+" y1=0 x2="+d+" y2="+c+" stroke='#444' stroke-width=1.5></line>";
		return g+="<line "+f+" x1="+d+" y1="+c+" x2="+(d-e/2)+" y2="+(c-e)+" stroke='#444' stroke-width=1></line>",g+="<line "+f+" x1="+d+" y1="+c+" x2="+(d+e/2)+" y2="+(c-e)+" stroke='#444' stroke-width=1></line>","<svg style='margin:0px;
		padding:0px;
		' height="+c+" width="+c+">"+g+"</svg><br>"
	}
	function e(a){
		L!=a&&(f(),L=a,K[a].cells.forEach(function(a){
			a.style.backgroundColor="#ffffff"
		}
		),K[L].onover.forEach(function(a){
			a()
		}
		))
	}
	function f(){
		L>=0&&(K[L].cells.forEach(function(a){
			a.style.backgroundColor=""
		}
		),K[L].onout.forEach(function(a){
			a()
		}
		)),L=-1
	}
	function g(a,b,d){
		var e="",f=0,g=(b-a.length*f)/a.length,h=0;
		return a.forEach(function(a,b){
			var i=(f+g)*b,j=a.ws,k=a.wg;
			h+=j;
			var l=d-12,m=20*(j-J)/(I-J+1),n=c(Math.min(19,Math.max(0,m))),o=(j-J)*l/(I-J)+12;
			if(e+="<rect x="+i+" y="+(d-o)+" width="+g+" height="+o+' style="fill:'+n+';
				" />',j!=k){
				var p=20*(k-J)/(I-J+1),q=c(Math.min(19,Math.max(0,p))),r=(k-j)*l/I;
				e+="<rect x="+i+" y="+(d-r-o)+" width="+g+" height="+r+' style="fill:'+q+';
				" />'
			}

	}
			),h=Math.round(h/a.length),e+='<text font-family="sans-serif" font-size=12 x='+b/2+" y="+(d-2)+' text-anchor="middle" fill="black">'+h+"</text>","<svg height="+d+" width="+b+' style="margin:0 0 3px 0">'+e+"</svg>"
}
function h(a,b,c,d,e,f){
	var g="",h=0,i=a.length,j=d/i,k=void 0,l=a[i>1?1:0][b];
	a.forEach(function(a){
		var c=2+(e-2)*(a[b]-D[b])/(C[b]-D[b]),d=aqiColor(a[b],"b","rh"==b?"h":b);
		g+="<rect x="+h+" y="+(e-c)+" width="+j+" height="+c+' style="fill:'+d+';
		" />',h+=j,"t"==b&&(a[b]==B[H][b].min&&(k="#44f",l=a[b],B[H][b].min=-888),a[b]==B[H][b].max&&(k="#f44",l=a[b],B[H][b].max=888))
	}
	);
	var m='font-family="sans-serif" ';
	return k?m+=" font-weight=bold font-size="+(f+1)+" ":(k="#888",m+=" font-weight=lighter font-size="+f+" "),l=Math.round("t"==b?aqi18n.getTemperature(l):l),g+="<text  x="+d/2+" y="+(e+10)+" "+m+' text-anchor="middle" fill="'+k+'">'+l+c+"</text>","<svg height="+(e+12)+" width="+d+" >"+g+"</svg>"
}
if(view=document.getElementById(b),0==a.length)return void(view.style.display="none");
view.style.display="";
var i=22,j=document.getElementById("aqif-table"),k=document.getElementById("wfdir"),l=document.getElementById("wfcol"),m=document.getElementById("wfhour"),n=document.getElementById("wfmet-rh"),o=document.getElementById("wfday"),p=document.getElementById("wfday-below"),q=[k,l,m,n,o,p],r=["pm25","pm10","o3"],s=(document.getElementById("wfhour"),{

}
																);
for(var t in r){
	t=r[t];
	var u=document.getElementById("wfaqi"+("pm25"!=t?"-"+t:""));
	u&&(s[t]=u,q.push(u))
}
var v=a,w=0,x=getWindowWidth();
x>800?x-=350:x>650&&(x-=250);
for(var y=!1,z=0;
	z<v.length;
	z++)v[z].aqi&&(y=!0);
for(var A=y?28:38,B=[],C={

}
	,D={

	}
	,E=0,z=0;
	z<v.length;
	z++){
	var F=v[z].t.split(/[^0-9]/),G=v[z].date=new Date(F[0],F[1]-1||0,F[2]||1,F[3]||0,F[4]||0,F[5]||0,F[6]||0),H=G.getDay();
	v[z].wind.forEach(function(a){
		["ws","wg","t","rh"].forEach(function(b){
			var c=a[b];
			E||(D[b]=C[b]=c),C[b]=Math.max(C[b],c),D[b]=Math.min(D[b],c),H in B||(B[H]={

			}
			),b in B[H]||(B[H][b]={
				min:c,max:c
			}
			),B[H][b].min=Math.min(B[H][b].min,c),B[H][b].max=Math.max(B[H][b].max,c)
		}
		),E=1
	}
	)
}
var I=Math.max(C.ws,C.wg),J=Math.min(D.ws,D.wg),K=[],L=-1;
j&&(j.onmouseout=function(){
	f()
}
																);
for(var M,N,O=[],P={

}
	,z=0;
z<v.length;
z++){
	var N=v[z].date,H=N.getDay();
	if(M&&M.getHours()>N.getHours()){
		var Q=w>2?aqi18n.getDate(M,"date"):"",R=o.insertCell(-1);
		R.style.fontVariant="small-caps",R.colSpan=w,R.innerHTML=Q,p&&(R=p.insertCell(-1),R.colSpan=w,R.innerHTML=Q),w=1,q.forEach(function(a){
			if(a){
				var b=a.insertCell(-1);
				b.style.width="2px",b=a.insertCell(-1),b.style.borderLeftColor="#888888",b.style.borderLeftStyle="solid",b.style.borderWidth="1px"
			}

		}
		)
	}
	else w++;
	var S=n?n.insertCell(-1):null,T=k.insertCell(-1),U=l.insertCell(-1),V=m.insertCell(-1),W=[T,U,V];
	S&&W.push(S);
	var X={

	}
	;
	for(var t in r)if(t=r[t],s[t]){
		var R=s[t].insertCell(-1);
		X[t]=R,W.push(R)
	}
	var Y={
		cells:W,onover:[],onout:[]
	}
	;
	if(K[z]=Y,W.forEach(function(a){
		var b=z;
		a.onmouseover=function(){
			e(b)
		}

	}
	),V.innerHTML=N.getHours(),v[z].wind.length){
		var Z=g(v[z].wind,i,A)+"<br>"+d(i,v[z].wind[0].wd);
		U.innerHTML=Z,T.innerHTML=h(v[z].wind,"t","°",i,22,11),S&&(S.innerHTML=h(v[z].wind,"rh","%",i,22,10))
	}
	else S&&(S.innerHTML=""),U.innerHTML="",T.innerHTML="";
	r.forEach(function(a){
		var b,c=i-2,d='<svg height="'+c+'" width="'+c+'" style="margin:1px;
		">',e="",f="",g=1,h=!0,j=v[z].aqi;
		if(j&&(b=j.v[a],b||"pm25"!=a||(h=!1,b=j.v)),b){
			P[a]=!0;
			var k=[aqiForecastColor(b[0],h),aqiForecastColor(b[1],h)];
			k[0]==k[1]?(d+='<polygon points="0,0 '+c+",0 "+c+","+c+" 0,"+c+'" style="fill:'+k[0]+';
				" />',e=aqi18n.getDate(N)+"\nAQI: "+b[0],f=b[0],g=2):(d+='<polygon points="0,0 '+c+",0 0,"+c+'" style="fill:'+k[0]+';
				" /><polygon points="'+c+",0 "+c+","+c+" 0,"+c+'" style="fill:'+k[1]+';
				" />',e=aqi18n.getDate(N)+"\nAQI: "+b[0]+" -> "+b[1],f=b[0]+"<br>"+b[1])
			}
		else d+='<polygon points="0,0 '+c+",0 "+c+","+c+" 0,"+c+'" style="fill:#eee;
		" />';
		if(d+="</svg>",X[a]){
			var l=document.createElement("div");
			l.style.display="none",l.style.height="0",l.style.width=i+"px",l.style.position="relative",l.style.zIndex=1;
			var m=document.createElement("div");
			m.style.paddingTop="1px",m.style.textAlign="center",m.style.lineHeight=g,m.style.fontSize=i/2-1+"px",m.style.fontFamily="sans-serif",m.style.backgroundColor="rgba(255,255,255,.3)",m.innerHTML=f,l.appendChild(m);
			var n=document.createElement("div");
			n.innerHTML=d,X[a].appendChild(l),X[a].appendChild(n),X[a].title=e,Y.onout.push(function(){
				l.style.display="none"
			}
			),Y.onover.push(function(){
				l.style.display="block"
			}
			)
		}

	}
			),M=N,O=W
}
if(w){
	var $=o.insertCell(-1);
	$.colSpan=w,$.innerHTML=N&&w>2?aqi18n.getDate(N,"date"):"",$.backgroundColor="yellow"
}
r.forEach(function(a){
	!P[a]&&s[a]&&(s[a].style.display="none")
}
																		)
}
window.aqi18n={
	strings:[],get:function(a,b){
		if(b=b||{

		}
			,a in this.strings){
			var c=this.strings[a];
			for(k in b)c=c.replace(k,b[k]);
			return c
		}
		return null
	}
	,register:function(a,b){
		this.strings[a]=b
	}
	,getDateTime:function(a){
		return this.getDate(a,"datetime")
	}
	,getDayName:function(a){
		var b="undefined"!=typeof getLang?getLang():"en",c=aqi18nGetDays();
		c=c[b in c?b:"en"];
		var d=a.getDay()-1;
		return-1==d&&(d=6),c[d]
	}
	,getDate:function(a,b){
		b=b||"date";
		var c="undefined"!=typeof getLang?getLang():"en",d=aqi18nGetDays();
		d=d[c in d?c:"en"];
		var e=a.getDay()-1;
		if(-1==e&&(e=6),"longdatetime"==b||"longdate"==b){
			var f=this.getMonthName(a.getMonth());
			s=d[e]+", "+f+" "+a.getDate()+" "+a.getFullYear()
		}
		else s=d[e]+" "+a.getDate();
		if("datetime"==b||"longdatetime"==b){
			var g=a.getHours();
			10>g&&(g="0"+g),s+=" - "+g+":00"
		}
		return s
	}
	,getDayShortName:function(a){
		var b={
			en:"Sun_Mon_Tue_Wed_Thu_Fri_Sat",fr:"dim._lun._mar._mer._jeu._ven._sam.",de:"So._Mo._Di._Mi._Do._Fr._Sa.",cn:"周日_周一_周二_周三_周四_周五_周六",es:"dom._lun._mar._mié._jue._vie._sáb.",vn:"CN_T2_T3_T4_T5_T6_T7",pl:"nie_pon_wt_śr_czw_pt_sb",ru:"вс_пн_вт_ср_чт_пт_сб",br:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb",kr:"일_월_화_수_목_금_토",jp:"日_月_火_水_木_金_土",hk:"週日_週一_週二_週三_週四_週五_週六"
		}
		;
		a-=1,0>a&&(a+=7);
		var c="undefined"!=typeof getLang?getLang():"en";
		c in b||(c="en");
		var d=b[c].split("_");
		return d[a]
	}
	,getMonthName:function(a){
		var b={
			en:"January_February_March_April_May_June_July_August_September_October_November_December",fr:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre",de:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember",cn:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月",es:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre",vn:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12",pl:"styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień",ru:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь",br:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro",kr:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월",jp:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月"
		}
			,c="undefined"!=typeof getLang?getLang():"en";
		"hk"==c&&(c="cn"),c in b||(c="en");
		var d=b[c].split("_");
		return d[a]
	}
	,getShortMonthName:function(a){
		var b={
			en:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec",cn:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月",kr:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월",jp:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月"
		}
			,c="undefined"!=typeof getLang?getLang():"en";
		"hk"==c&&(c="cn"),c in b||(c="en");
		var d=b[c].split("_");
		return d[a]
	}
	,getTemperatureUnit:function(){
		return 1==store.get("aqicn-settings-temp")?"F":"C"
	}
	,getTemperature:function(a){
		return"F"==this.getTemperatureUnit()?celciusToFahrenheit(a):a
	}

}
	,AirPromise.prototype={
		then:function(a,b){
			this._thens.push({
				resolve:a,reject:b
			}
			)
		}
		,resolve:function(a,b){
			this._complete("resolve",a)
		}
		,reject:function(a){
			this._complete("reject",a)
		}
		,_complete:function(a,b){
			"resolve"===a?(this._info+=" - resolved",this.then=function(a,c){
				a&&a(b)
			}
			):(this._info+=" - rejected",this.then=function(a,c){
				c&&c(b)
			}
			),this.reject=function(){
				throw new Error("AirPromise ("+this._info+") already completed (reject requested).")
			}
				,this.resolve=function(a,b){
					throw new Error("AirPromise ("+this._info+") already completed (resolve requested).")
				}
			;
			for(var c,d=0;
				c=this._thens[d++];
			)c[a]&&c[a](b);
			delete this._thens
		}

	}
;
var waqiloader={
	jsonp:{

	}

}
	,aqisrv=function(a){
		function b(d){
			if(c[d])return c[d].exports;
			var e=c[d]={
				exports:{

				}
				,id:d,loaded:!1
			}
			;
			return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports
		}
		var c={

		}
		;
		return b.m=a,b.c=c,b.p="",b(0)
	}
([function(module,exports,__webpack_require__){
	"use strict";
	function obs(a){
		return"@"==a[0]&&(a=a.substr(1)),api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/feed/@"+a+"/obs."+api_fetch_1.lang()+".json",{
			id:a
		}
		)
	}
	function now(a){
		return"@"==a[0]&&(a=a.substr(1)),0>a||"-1"==a?api_promise_1.Promise.create(function(a,b){
			return b("Invalid ID")
		}
		):api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/feed/@"+a+"/now.json",{

		}
		)
	}
	function widget(a){
		return"@"==a[0]&&(a=a.substr(1)),a="@"+a,api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/widget/"+a+"/widget.v1.json",{
			id:a
		}
		)
	}
	function mapib(a){
		var b=api_fetch_1.apiserver()+"/mapib/@cid/info"+("en"!=api_fetch_1.lang()?"."+api_fetch_1.lang():"")+".json";
		return isNaN(a)?(b=b.replace("@cid","!"+a.replace("/",",").toLowerCase()),api_fetch_1.requestJSON(b,{

		}
		)):api_fetch_1.requestJSON(b.replace("cid",api_fetch_1.pad(a,8)),{
			id:a
		}
		)
	}
	function att(a,b){
		return b=b||{

		}
			,b.id=a,api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/att/"+a+"/"+b.type+".json",b)
	}
	function ui(a){
		return new api_ui_1.UI(a)
	}
	function sensor(a){
		return new Sensor(a)
	}
	function forecast(a,b){
		return new Forecast(a,b)
	}
	function ntfGeolocMobile(a){
		return exports.ntf.geoloc(a,!0)
	}
	function ntfGeoloc(a){
		return exports.ntf.geoloc(a)
	}
	function ntfInfo(a){
		return exports.ntf.info(a)
	}
	function ntfRefresh(a){
		return exports.ntf.refresh(a)
	}
	function updater(state){
		function load(url,callback){
			var r=new XMLHttpRequest,t=(new Date).getTime();
			r.open("GET",url+"?_"+t,!0),r.onreadystatechange=function(){
				if(4==r.readyState&&200==r.status){
					var sjson=r.responseText,json=eval("("+sjson+")");
					callback(json)
				}

			}
				,r.send("")
		}
		function check(){
			var a=getWidgetAqiGraphModel();
			if(a){
				var b=a.city.idx;
				load(api_fetch_1.feedserver()+"/xservices/refresh:"+b,function(c){
					var d=a.timestamp;
					c.stime-d>0&&obs(b).then(function(b){
						b.timestamp>a.timestamp&&(console.log(b,c),updateWidgetAqiGraph(b),state.stime=b.timestamp)
					}
					)
				}
				)
			}

		}
		setInterval(function(){
			check()
		}
			,6e4)
	}
	function here(){
		return gHerePromise||(gHerePromise=api_fetch_1.requestJSON(api_fetch_1.windserver()+"/mapq/here",{

		}
		)),gHerePromise
	}
	function fetch(a){
		return api_fetch_1.requestJSON(a,{

		}
		)
	}
	var api_fetch_1=__webpack_require__(1),api_xmlhttp_1=__webpack_require__(3),api_promise_1=__webpack_require__(2),api_pubsub_1=__webpack_require__(6),api_ui_1=__webpack_require__(4);
	exports.obs=obs,exports.now=now,exports.widget=widget,exports.mapib=mapib,exports.att=att,exports.ui=ui;
	var Sensor=function(){
		function a(a){
			this.promises=[],this.sensorid=a
		}
		return a.prototype.realtime=function(){
			var a=this;
			return api_pubsub_1.PubSub.createPeriodic(function(b,c){
				var d=api_fetch_1.apiserver()+"/sensor/"+a.sensorid+"/rt.json";
				api_fetch_1.requestJSON(d,{
					id:-1
				}
				).then(function(a){
					return b(a)
				}
					,function(a){
						return c(a)
					}
				)
			}
				,3e5)
		}
			,a.prototype.timeseries=function(a){
				void 0===a&&(a="def");
				var b=api_fetch_1.apiserver()+"/sensor/"+this.sensorid+"/"+a+"/ts.json";
				return api_fetch_1.requestJSON(b,{
					id:-1
				}
				)
			}
			,a
	}
	();
	exports.sensor=sensor;
	var Nearest=function(){
		function a(){

		}
		return a.prototype.station=function(a){
			return api_fetch_1.requestJSON(api_fetch_1.windserver()+"/mapq/nearest/station/"+a+"?n=20",{
				id:a
			}
			)
		}
			,a.prototype.ip=function(){
				return api_fetch_1.requestJSON(api_fetch_1.windserver()+"/mapq/nearest/?n=20",{
					id:-1
				}
				)
			}
			,a.prototype.geo=function(a,b){
				return api_fetch_1.requestJSON(api_fetch_1.windserver()+"/mapq/nearest/?n=20&geo=1/"+a+"/"+b,{
					id:-1
				}
				)
			}
			,a
	}
	();
	exports.nearest=new Nearest;
	var Search=function(){
		function a(){

		}
		return a.prototype.station=function(a){
			var b=api_fetch_1.windserver()+"/nsearch/station/"+a;
			return api_fetch_1.requestJSON(b,{
				type:"city"
			}
			)
		}
			,a.prototype.city=function(a){
				var b=api_fetch_1.windserver()+"/nsearch/city/"+a;
				return api_fetch_1.requestJSON(b,{
					type:"city"
				}
				)
			}
			,a.prototype.place=function(a){
				var b=api_fetch_1.windserver()+"/nsearch/places/"+a;
				return api_fetch_1.requestJSON(b,{
					type:"places"
				}
				)
			}
			,a.prototype.full=function(a,b){
				var c=api_fetch_1.windserver()+"/nsearch/full/"+a;
				return b&&b.n&&20!=b.n&&(c+="?n="+b.n),api_fetch_1.requestJSON(c,{
					type:"full"
				}
				)
			}
			,a
	}
	();
	exports.search=new Search;
	var Forecast=function(){
		function a(a,b){
			this.model=a,this.pol=b
		}
		return a.prototype.historicalFromLatLng=function(a,b,c){
			void 0===c&&(c=1);
			var d=api_fetch_1.apiserver()+"/forecast/historical";
			return api_fetch_1.requestJSON(d,{
				post:{
					lat:a,lng:b,day:c,model:this.model,pol:this.pol
				}

			}
			)
		}
			,a.prototype.nowcastFromLatLng=function(a,b){
				var c=api_fetch_1.apiserver()+"/forecast/nowcast";
				return api_fetch_1.requestJSON(c,{
					post:{
						lat:a,lng:b,model:this.model,pol:this.pol
					}

				}
				)
			}
			,a
	}
	();
	exports.forecast=forecast;
	var CWOP=function(){
		function a(){

		}
		return a.prototype.station=function(a){
			var b=api_fetch_1.apiserver()+"/cwop/station/"+a;
			return api_fetch_1.requestJSON(b,{

			}
			)
		}
			,a
	}
	();
	exports.cwop=new CWOP;
	var Notification=function(){
		function a(){

		}
		return a.prototype.geoloc=function(a,b){
			return void 0===b&&(b=!1),"@"==a[0]&&(a=a.substr(1)),api_promise_1.Promise.create(function(c,d){
				api_fetch_1.requestJSON(api_fetch_1.windserver()+"/mapq/nearest?from="+a,{

				}
				).then(function(d){
					if(!(d.g.distance<150)){
						var e=aqi18n.get("city-"+a),f=d.g.city,g=d.d[0].nlo;
						d.d[0].nna&&(g+=" ("+d.d[0].nna+")");
						var h=d.g.iso2.toLowerCase(),i="/images-static/flags/"+h+".png",j=aqi18n.get("NO_THANKS"),k="/city/@"+d.d[0].x,l={
							fr:"fr",cn:"cn",es:"es",hk:"hk",tw:"hk",kr:"kr",ko:"kr",ja:"jp",jp:"jp",co:"es"
						}
							,m=(l[h]?"/"+l[h]:"","");
						if(b)m=aqi18n.get("WA_SHOW_CURRENT_LOCATION"),m=m.replace("%1","__CITY__"),m=m.replace("__CITY__","<b><a>"+g+"</a></b>"),k+="/m";
						else if(f&&f.length>0)m=aqi18n.get("WEB_AUTOLOCATE_INFO"),m=m.replace("__CITYIP1__","<b><a>"+f+"</a></b>"),m=m.replace("__CITYIP2__","<a>"+g+"</a>");
						else{
							var n=d.g.country;
							m=aqi18n.get("WEB_AUTOLOCATE_COUNTRYINFO"),m=m.replace("__CITYIP__","<b><a>"+n+"</a></b>"),m=m.replace("__COUNTRY__","<b><a>"+n+"</a></b>")
						}
						m=m.replace("__CITYID__","<a>"+e+"</a>"),m=m.replace("188",""+Math.round(d.g.distance)),m=m.replace("__CITYDIST__KM","188");
						var o={
							img:"<img src='"+i+"' width=48 height=48>",url:i
						}
							,p={
								url:k,flag:o,nope:j,msg:m
							}
						;
						c(p)
					}

				}
				)
			}
			)
		}
			,a.prototype.info=function(a){
				return api_promise_1.Promise.create(function(b,c){
					var d=a.page||"main",e=api_fetch_1.server("")+"/services/ntf:"+d;
					api_xmlhttp_1.fetchJSON(e,a).then(function(a){
						a&&b(a)
					}
						,function(a){

						}
					)
				}
				)
			}
			,a.prototype.refresh=function(a){
				return api_promise_1.Promise.create(function(b,c){
					var d=a.id;
					"@"==d[0]&&(d=d.substr(1)),api_fetch_1.requestJSON(api_fetch_1.frontendserver()+"/xservices/refresh:"+d,{

					}
					).then(function(c){
						b(c.stime-a.stime>0)
					}
					)
				}
				)
			}
			,a
	}
	();
	exports.ntf=new Notification,exports.ntfGeolocMobile=ntfGeolocMobile,exports.ntfGeoloc=ntfGeoloc,exports.ntfInfo=ntfInfo,exports.ntfRefresh=ntfRefresh,exports.updater=updater;
	var gHerePromise=void 0;
	exports.here=here;
	var map=function(){
		function a(){

		}
		return a.loader=function(a){
			return api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/map/sel",{
				post:{
					page:a
				}

			}
			)
		}
			,a.stat=function(a,b){
				return api_fetch_1.requestJSON(api_fetch_1.apiserver()+"/map/stat",{
					post:{
						server:a,time:b
					}

				}
				)
			}
			,a
	}
	();
	exports.map=map,exports.fetch=fetch
}
	,function(a,b,c){
		"use strict";
		function d(){
			for(var a=[],b=0;
				b<arguments.length;
				b++)a[b-0]=arguments[b]
		}
		function e(){
			try{
				return getLang()
			}
			catch(a){

			}
			return"en"
		}
		function f(a,b,e){
			return void 0===b&&(b={

			}
			),void 0===e&&(e=3600),q.Promise.create(function(f,g){
				if(void 0==a)return void f("na");
				if(-1==a)return void f("-1");
				var h="waqi-api-tok-"+a,j=c(5),k=null;
				try{
					k=j.get(h)
				}
				catch(l){

				}
				var m=(new Date).getTime();
				if(k&&(m-k.time)/1e3<e)return void f(k.token);
				var n=p()+"/token/"+a,o=i();
				b.uid=o,r.fetchJSON(n,b).then(function(a){
					if(a.token)j.set(h,{
						token:a.token,time:m
					}
					),f(a.token);
					else if(a.rxs&&a.rxs.uids&&a.rxs.uids[o]){
						var b=a.rxs.uids[o].msg.token;
						j.set(h,{
							token:b,time:m
						}
						),f(b)
					}

				}
					,function(a){
						d("Token:oops...",a),f("-x-")
					}
				)
			}
			)
		}
		function g(a,b,c){
			void 0===c&&(c=void 0),b.id&&(b.id=(""+b.id).replace("@","")),b.promise||(b.promise=new q.Promise),b.count=b.count||0;
			var d=b.promise;
			return f(b.id).then(function(e){
				var j=i(),k=(p(),{
					token:e,captcha:c,uid:j
				}
				);
				if(b.post)for(var l in b.post)k[l]=b.post[l];
				var m=!1;
				k.rqc=2*++t;
				try{
					var n="han",o="om";
					m=!!window["callP"+n+"t"+o]
				}
				catch(q){

				}
				m&&(k.rqc+=1),r.fetchJSON(a,k).then(function(c){
					function e(c){
						var e=c.status;
						if("captcha"==e)if(b.captchaId&&b.count<10){
							var i="function"==typeof b.captchaId?b.captchaId(b):b.captchaId;
							s.UI.create(i).captcha().then(function(c){
								b.count++,g(a,b,c)
							}
								,function(a){
									d.reject(a)
								}
							)
						}
						else d.reject("too many retries");
						else if("retry"==e)if(b.count<20){
							var j=c.delay||30;
							console.log("retrying - delay:"+j+" [x"+b.count+"]"),setTimeout(function(){
								b.count++,g(a,b)
							}
								,1e3*(j+Math.random()))
						}
						else d.reject("too many retries");
						else"nug"==e?h().then(function(a){
							a[0]+=128,f("hbs",{
								k:btoa(JSON.stringify(a))
							}
								,10)
						}
							,function(a){

							}
						):"200"==e||"ok"==e?d.resolve(c.msg):d.reject("Unknown status `"+e+"`")
					}
					c&&c.rxs?c.rxs.obs.forEach(function(a){
						e(a)
					}
					):(c&&c.xaqsts&&"nug"==c.xaqsts&&e({
						status:"nug"
					}
					),c&&c.apisrv&&c.apisrv.status?e(c.apisrv):d.resolve(c))
				}
					,function(a){
						d.reject(a)
					}
				)
			}
				,function(a){
					d.reject(a)
				}
			),d
		}
		function h(a){
			if(void 0===a&&(a=!1),u)return{
				then:function(a,b){

				}

			}
			;
			a||(u=!0);
			var b=(new Date).getTime();
			return q.Promise.create(function(c,d){
				function e(){
					var a=document.documentElement.scrollTop||document.body.scrollTop;
					g()&&c([0,a,window.innerHeight,(new Date).getTime()-b,i?1:0])
				}
				function f(a){
					g()&&c([1,a.pageX,a.pageY,(new Date).getTime()-b,i?1:0])
				}
				function g(){
					var b=!h;
					return window.removeEventListener("mousemove",f,!1),window.removeEventListener("scroll",e,!0),h=!0,a||(u=!1),b
				}
				var h=!1,i=!1;
				try{
					var j="han",k="om";
					i=!!window["callP"+j+"t"+k]
				}
				catch(l){

				}
				window.addEventListener("scroll",e,!0),window.addEventListener("mousemove",f,!1)
			}
			)
		}
		function i(){
			return j(5)+(new Date).getTime()
		}
		function j(a){
			void 0===a&&(a=15);
			for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c="",d=-1;
				++d<a;
			)c+=b.charAt(Math.floor(52*Math.random()));
			return c
		}
		function k(a,b){
			return(1e15+a+"").slice(-b)
		}
		function l(a,b){
			return void 0===a&&(a="api."),void 0===b&&(b="waqi.info"),window.location.protocol+"//"+a+b
		}
		function m(){
			return l("feed.","aqicn.org")
		}
		function n(){
			return l("","aqicn.org")
		}
		function o(){
			return"https://wind.waqi.info"
		}
		function p(){
			return"https://api.waqi.info/api"
		}
		var q=c(2),r=c(3),s=c(4);
		b.lang=e,b.token=f;
		var t=0;
		b.requestJSON=g;
		var u=!1;
		try{
			h(!0).then(function(a){
				f("hbs",{
					k:btoa(JSON.stringify(a))
				}
					,900)
			}
				,function(a){

				}
			)
		}
		catch(v){

		}
		b.rand=j,b.pad=k,b.server=l,b.feedserver=m,b.frontendserver=n,b.windserver=o,b.apiserver=p
	}
	,function(a,b){
		"use strict";
		var c=function(){
			function a(){
				this._thens=[]
			}
			return a.create=function(b){
				var c=new a;
				return b(c.resolve.bind(c),c.reject.bind(c)),c
			}
				,a.prototype.then=function(a,b){
					this._thens.push({
						resolve:a,reject:b
					}
					)
				}
				,a.prototype.resolve=function(a){
					this._complete("resolve",a)
				}
				,a.prototype.reject=function(a){
					this._complete("reject",a)
				}
				,a.prototype.chain=function(a){
					this.then(function(b){
						return a.resolve(b)
					}
						,function(b){
							return a.reject(b)
						}
					)
				}
				,a.prototype._complete=function(a,b){
					"resolve"===a?this.then=function(a,c){
						a&&a(b)
					}
						:this.then=function(a,c){
							c&&c(b)
						}
						,this.reject=function(){
							throw new Error("Promise already completed (reject requested).")
						}
						,this.resolve=function(a){
							throw new Error("Promise already completed (resolve requested).")
						}
					;
					for(var c,d=0;
						c=this._thens[d++];
					)c[a]&&c[a](b);
					delete this._thens
				}
				,a
		}
		();
		b.Promise=c
	}
	,function(module,exports,__webpack_require__){
		"use strict";
		function log(){
			for(var a=[],b=0;
				b<arguments.length;
				b++)a[b-0]=arguments[b]
		}
		function key(){
			try{
				return jskey()
			}
			catch(a){

			}
			return"-"
		}
		function decorate(a){
			return a
		}
		function fetchJSON(url,headers){
			void 0===headers&&(headers=void 0);
			var p=new api_promise_1.Promise,r=new XMLHttpRequest;
			r.onerror=function(a){
				log("Can not load "+url,a),p.reject(a.toString())
			}
				,r.open("POST",decorate(url),!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){
					if(4==r.readyState&&200==r.status){
						var sjson=r.responseText;
						if(null==sjson||0==sjson.length)return p.resolve(null);
						var json,s="("+sjson+")";
						try{
							json=eval(s)
						}
						catch(e){
							return log("Can not eval JSON",s),void p.reject("Wrong JSON")
						}
						json.rxs&&json.rxs.status&&"ok"==json.rxs.status&&(json.rxs.uids={

						}
							,json.rxs.obs.forEach(function(a){
								a.uid&&(json.rxs.uids[a.uid]=a)
							}
							)),p.resolve(json)
					}

				}
			;
			var post="key="+key();
			if(headers)for(var k in headers)headers[k]&&(post+="&"+k+"="+headers[k]);
			return r.send(post),p
		}
		var api_promise_1=__webpack_require__(2);
		exports.key=key,exports.fetchJSON=fetchJSON
	}
	,function(a,b,c){
		"use strict";
		var d=c(2),e=c(1),f=function(){
			function a(a){
				a?"function"==typeof a.node?this.div=a.node():"string"==typeof a&&"#"==a[0]?this.div=document.getElementById(a.substr(1)):"string"==typeof a?this.div=document.getElementById(a):this.div=a:this.div=a
			}
			return a.create=function(b){
				return new a(b)
			}
				,a.prototype.errorNtf=function(a){
					this.div.innerHTML='\n            <center>\n            <div class=\'ui error\'>\n            <svg id="Layer_3" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="55" width="68" version="1.0" viewBox="0 0 627.769 550.45">\n            <path id="path2231" fill="#ea0000" d="m614.57 504.94l-279.4-483.94c-4.38-7.588-12.47-12.262-21.23-12.262s-16.85 4.674-21.23 12.258l-279.41 483.94c-4.375 7.58-4.375 16.93 0.003 24.52 4.379 7.58 12.472 12.25 21.23 12.25h558.81c8.76 0 16.86-4.67 21.23-12.25 4.38-7.59 4.38-16.94 0-24.52z"/>\n            <polygon id="polygon2233" points="93.977 482.88 533.9 482.88 313.94 101.89" fill="#fff"/>\n            <path id="path2235" d="m291.87 343.36c1.21 11.49 3.21 20.04 6.02 25.66 2.81 5.63 7.82 8.43 15.04 8.43h2.01c7.22 0 12.24-2.8 15.04-8.43 2.81-5.62 4.82-14.17 6.02-25.66l6.42-88.75c1.21-17.3 1.81-29.71 1.81-37.25 0-10.25-2.91-18.25-8.73-23.99-5.53-5.46-13.38-8.59-21.56-8.59s-16.04 3.13-21.57 8.59c-5.81 5.74-8.72 13.74-8.72 23.99 0 7.54 0.6 19.95 1.8 37.25l6.42 88.75z"/>\n            <circle id="circle2237" cy="430.79" cx="313.94" r="30.747"/>\n            </svg>\n            <div class=\'title\'>\n            Ooops... Sorry, something wrong happenned\n            </div>\n            <div class=\'message\'>\n            '+a+"\n            </div>\n            </div>\n            </center>\n            "
				}
				,a.prototype.error=function(a){
					var b=this;
					return d.Promise.create(function(c,d){
						b.div.innerHTML='\n                <center>\n                <div class=\'ui error\'>\n                <svg id="Layer_3" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="55" width="68" version="1.0" viewBox="0 0 627.769 550.45">\n                <path id="path2231" fill="#ea0000" d="m614.57 504.94l-279.4-483.94c-4.38-7.588-12.47-12.262-21.23-12.262s-16.85 4.674-21.23 12.258l-279.41 483.94c-4.375 7.58-4.375 16.93 0.003 24.52 4.379 7.58 12.472 12.25 21.23 12.25h558.81c8.76 0 16.86-4.67 21.23-12.25 4.38-7.59 4.38-16.94 0-24.52z"/>\n                <polygon id="polygon2233" points="93.977 482.88 533.9 482.88 313.94 101.89" fill="#fff"/>\n                <path id="path2235" d="m291.87 343.36c1.21 11.49 3.21 20.04 6.02 25.66 2.81 5.63 7.82 8.43 15.04 8.43h2.01c7.22 0 12.24-2.8 15.04-8.43 2.81-5.62 4.82-14.17 6.02-25.66l6.42-88.75c1.21-17.3 1.81-29.71 1.81-37.25 0-10.25-2.91-18.25-8.73-23.99-5.53-5.46-13.38-8.59-21.56-8.59s-16.04 3.13-21.57 8.59c-5.81 5.74-8.72 13.74-8.72 23.99 0 7.54 0.6 19.95 1.8 37.25l6.42 88.75z"/>\n                <circle id="circle2237" cy="430.79" cx="313.94" r="30.747"/>\n                </svg>\n                <div class=\'title\'>\n                Ooops... Sorry, something wrong happenned\n                </div>\n                <div class=\'message\'>\n                '+a+"\n                </div>\n                <div class='ui btn large'>try again</div>\n                </div>\n                </center>\n                ";
						var e=function(){
							b.div.removeEventListener("click",e),b.div.innerHTML="",setTimeout(function(){
								c(!0)
							}
								,100)
						}
						;
						b.div.addEventListener("click",e)
					}
					)
				}
				,a.prototype.loading=function(){
					this.div.innerHTML="<center>"+this.spinner()+"</center>"
				}
				,a.prototype.spinner=function(){
					return'<div class="aqspinner3"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div></div>'
				}
				,a.prototype.captcha=function(){
					var a=this;
					return d.Promise.create(function(b,c){
						if(window.grecaptcha){
							var d=e.rand();
							a.div.innerHTML="<center><div id='"+d+"'></div></center>",window.grecaptcha.reset(),window.grecaptcha.render(d,{
								sitekey:"6LdrdwITAAAAAPy8Zp-PqaGhVWJvqdMILAzaEeVy",callback:function(c){
									a.div.innerHTML="<center>All right, loading data...<br>"+a.spinner()+"</center>",b(c)
								}

							}
							)
						}
						else{
							var f=e.rand();
							a.div.innerHTML="<center><div id='"+f+"'>Please wait, while loading extra scripts...<br>"+a.spinner()+"</div></center>";
							var g="cb_"+e.rand();
							window[g]=function(){
								document.getElementById(f).innerHTML="",window.grecaptcha.render(f,{
									sitekey:"6LdrdwITAAAAAPy8Zp-PqaGhVWJvqdMILAzaEeVy",callback:function(c){
										a.div.innerHTML="<center><div id='"+f+"'>All right, loading data...<br>"+a.spinner()+"</div></center>",b(c)
									}

								}
								)
							}
							;
							var h=document.createElement("script");
							h.type="text/javascript",h.async=!0,h.src="https://www.google.com/recaptcha/api.js?onload="+g+"&render=explicit",document.getElementsByTagName("head")[0].appendChild(h)
						}

					}
					)
				}
				,a.prototype.html=function(a){
					return this.div.innerHTML=a,this
				}
				,a.prototype.show=function(){
					return this.div.style.display="block",this
				}
				,a.prototype.hide=function(){
					return this.div.style.display="none",this
				}
				,a.prototype.slideDown=function(){
					var a=window.$;
					return a?a(this.div).slideDown():this.show(),this
				}
				,a
		}
		();
		b.UI=f
	}
	,function(a,b,c){
		var d,e,f;
		(function(c){
			"use strict";
			!function(c,g){
				e=[],d=g,f="function"==typeof d?d.apply(b,e):d,!(void 0!==f&&(a.exports=f))
			}
			(this,function(){
				function a(){
					try{
						return g in e&&e[g]
					}
					catch(a){
						return!1
					}

				}
				var b,d={

				}
					,e="undefined"!=typeof window?window:c,f=e.document,g="localStorage",h="script";
				if(d.disabled=!1,d.version="1.3.20",d.set=function(a,b){

				}
					,d.get=function(a,b){

					}
					,d.has=function(a){
						return void 0!==d.get(a)
					}
					,d.remove=function(a){

					}
					,d.clear=function(){

					}
					,d.transact=function(a,b,c){
						null==c&&(c=b,b=null),null==b&&(b={

						}
						);
						var e=d.get(a,b);
						c(e),d.set(a,e)
					}
					,d.getAll=function(){

					}
					,d.forEach=function(){

					}
					,d.serialize=function(a){
						return JSON.stringify(a)
					}
					,d.deserialize=function(a){
						if("string"==typeof a)try{
							return JSON.parse(a)
						}
						catch(b){
							return a||void 0
						}

					}
					,a())b=e[g],d.set=function(a,c){
						return void 0===c?d.remove(a):(b.setItem(a,d.serialize(c)),c)
					}
					,d.get=function(a,c){
						var e=d.deserialize(b.getItem(a));
						return void 0===e?c:e
					}
					,d.remove=function(a){
						b.removeItem(a)
					}
					,d.clear=function(){
						b.clear()
					}
					,d.getAll=function(){
						var a={

						}
						;
						return d.forEach(function(b,c){
							a[b]=c
						}
						),a
					}
					,d.forEach=function(a){
						for(var c=0;
							c<b.length;
							c++){
							var e=b.key(c);
							a(e,d.get(e))
						}

					}
				;
				else if(f&&f.documentElement.addBehavior){
					var i,j;
					try{
						j=new ActiveXObject("htmlfile"),j.open(),j.write("<"+h+">document.w=window</"+h+'><iframe src="/favicon.ico"></iframe>'),j.close(),i=j.w.frames[0].document,b=i.createElement("div")
					}
					catch(k){
						b=f.createElement("div"),i=f.body
					}
					var l=function(a){
						return function(){
							var c=Array.prototype.slice.call(arguments,0);
							c.unshift(b),i.appendChild(b),b.addBehavior("#default#userData"),b.load(g);
							var e=a.apply(d,c);
							return i.removeChild(b),e
						}

					}
						,m=new RegExp("[!\"#$%&'()*+,/\\\\:;
							<=>?@[\\]^`{
								|
							}
							~]","g"),n=function(a){
							return a.replace(/^d/,"___$&").replace(m,"___")
						}
					;
					d.set=l(function(a,b,c){
						return b=n(b),void 0===c?d.remove(b):(a.setAttribute(b,d.serialize(c)),a.save(g),c)
					}
					),d.get=l(function(a,b,c){
						b=n(b);
						var e=d.deserialize(a.getAttribute(b));
						return void 0===e?c:e
					}
					),d.remove=l(function(a,b){
						b=n(b),a.removeAttribute(b),a.save(g)
					}
					),d.clear=l(function(a){
						var b=a.XMLDocument.documentElement.attributes;
						a.load(g);
						for(var c=b.length-1;
							c>=0;
							c--)a.removeAttribute(b[c].name);
						a.save(g)
					}
					),d.getAll=function(a){
						var b={

						}
						;
						return d.forEach(function(a,c){
							b[a]=c
						}
						),b
					}
						,d.forEach=l(function(a,b){
							for(var c,e=a.XMLDocument.documentElement.attributes,f=0;
								c=e[f];
								++f)b(c.name,d.deserialize(a.getAttribute(c.name)))
						}
						)
				}
				try{
					var o="__storejs__";
					d.set(o,o),d.get(o)!=o&&(d.disabled=!0),d.remove(o)
				}
				catch(k){
					d.disabled=!0
				}
				return d.enabled=!d.disabled,d
			}
			)
		}
		).call(b,function(){
			return this
		}
			())
	}
	,function(a,b){
		"use strict";
		var c=function(){
			function a(){
				this.subscribers=[]
			}
			return a.createPeriodic=function(b,c){
				var d=new a;
				return d.intervalID=setInterval(function(){
					b(d.emit.bind(d),d.error.bind(d))
				}
					,c),setTimeout(function(){
						return b(d.emit.bind(d),d.error.bind(d))
					}
						,100),d
			}
				,a.prototype.then=function(a,b){
					this.subscribers.push({
						eventhandler:a,errorhandler:b
					}
					),this.intervalID&&(clearInterval(this.intervalID),this.intervalID=null)
				}
				,a.prototype.error=function(a){
					this.subscribers.forEach(function(b){
						b.errorhandler&&b.errorhandler(a)
					}
					)
				}
				,a.prototype.emit=function(a){
					this.subscribers.forEach(function(b){
						b.eventhandler(a)
					}
					)
				}
				,a.prototype.subscribe=function(a,b){
					void 0===b&&(b=null),this.subscribers.push({
						eventhandler:a,errorhandler:b
					}
					)
				}
				,a
		}
		();
		b.PubSub=c
	}
]);
!function(a){
	if("function"==typeof define&&define.amd)define(a);
	else if("object"==typeof exports)module.exports=a();
	else{
		var b=window.Cookies,c=window.Cookies=a();
		c.noConflict=function(){
			return window.Cookies=b,c
		}

	}

}
(function(){
	function a(){
		for(var a=0,b={

		}
			;
			a<arguments.length;
			a++){
			var c=arguments[a];
			for(var d in c)b[d]=c[d]
		}
		return b
	}
	function b(c){
		function d(b,e,f){
			var g;
			if("undefined"!=typeof document){
				if(arguments.length>1){
					if(f=a({
						path:"/"
					}
						,d.defaults,f),"number"==typeof f.expires){
						var h=new Date;
						h.setMilliseconds(h.getMilliseconds()+864e5*f.expires),f.expires=h
					}
					try{
						g=JSON.stringify(e),/^[\{
							\[]/.test(g)&&(e=g)
						}
							catch(i){

							}
							return e=c.write?c.write(e,b):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),
							b=encodeURIComponent(String(b)),b=b.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),b=b.replace(/[\(\)]/g,escape),document.cookie=[b,"=",e,f.expires?";
								expires="+f.expires.toUTCString():"",f.path?";
								path="+f.path:"",f.domain?";
								domain="+f.domain:"",f.secure?";
								secure":""].join("")
							}
					b||(g={

					}
					);
					for(var j=document.cookie?document.cookie.split(";
						"):[],k=/(%[0-9A-Z]{
						2
					}
					)+/g,l=0;
					l<j.length;
					l++){
						var m=j[l].split("="),n=m.slice(1).join("=");
						'"'===n.charAt(0)&&(n=n.slice(1,-1));
						try{
							var o=m[0].replace(k,decodeURIComponent);
							if(n=c.read?c.read(n,o):c(n,o)||n.replace(k,decodeURIComponent),this.json)try{
								n=JSON.parse(n)
							}
							catch(i){

							}
							if(b===o){
								g=n;
								break
							}
							b||(g[o]=n)
						}
						catch(i){

						}

					}
	return g
}

}
return d.set=d,d.get=function(a){
	return d(a)
}
	,d.getJSON=function(){
		return d.apply({
			json:!0
		}
			,[].slice.call(arguments))
	}
			,d.defaults={

			}
			,d.remove=function(b,c){
				d(b,"",a(c,{
					expires:-1
				}
				))
			}
			,d.withConverter=b,d
	}
	return b(function(){

	}
	)
}
															),AqiGraphFactory.prototype.init=function(){
																var a=0;
																this.model.h={

																}
																;
																for(var b in this.model.iaqi){
																	var c=this.model.iaqi[b],d=c.p,e=c.h[0],f=36e5,g=[],h=new Date(e).getTime(),j=h,k=c.h[1];
																	c.h[2].forEach(function(a){
																		if("string"==typeof a)for(i in a){
																			j-=f;
																			var b=a.charCodeAt(i);
																			b>=97?b-=97:b=-(b-65)-1,g.push({
																				t:j,v:b/k,s:1
																			}
																			)
																		}
																		else"number"==typeof a?(j-=f,g.push({
																			t:j,v:a/k,s:1
																		}
																		)):(j-=a[0]*f,g.push({
																			t:j,v:a[1]/k,s:a[0]
																		}
																		))
																	}
																	);
																	var l=0;
																	g.forEach(function(a){
																		a.v+=l,l=a.v
																	}
																	),this.model.h[d]=g,(0==a||-1==["t","p","h","r","d","w"].indexOf(d))&&h>a&&(a=h)
																}
																this.model.maxt=a
															}
			,AqiGraphFactory.prototype.getData=function(a){
				return this.model.h[a]
			}
			,AqiGraphFactory.prototype.getGraph=function(a,b,c,d){
				var e=this.getData(c),f=document.createElement("canvas"),g=window.devicePixelRatio||1;
				a*=g,b*=g,f.width=a,f.height=b;
				var h=f.getContext("2d"),i=this.model.maxt;
				if(0==i)throw"Can not decode maxt";
				var j=Math.max(6*g,a/120),k=max=0;
				e&&e.forEach(function(b,c){
					var d=a-j-j*(i-b.t)/36e5;
					0>d||((0==c||b.v<k)&&(k=b.v),(0==c||b.v>max)&&(max=b.v))
				}
				);
				var l=new Date(i),m=l.getHours(),n=m%6;
				l=new Date(i-3600*n*1e3).getTime();
				for(var o=0;
					40>o;
					o++){
					var p=a-1*j-j*(i-l+6*o*3600*1e3)/36e5;
					if(0>p)break;
					h.beginPath(),h.fillStyle="#888888",h.rect(p,d?8*g:0,1,b),h.fill()
				}
				if(e&&k!=max)if(0>k&&max>0){
					var q=(0-k)*(d?b-8*g:b)/(max-k);
					e.forEach(function(e,f){
						var l=a-2*j-j*(i-e.t)/36e5,m=(e.v-k)*(d?b-8*g:b)/(max-k);
						h.beginPath(),h.fillStyle=aqiColor(e.v,"b",c),e.v<0?h.rect(l,b-m,Math.max(1,Math.min(3,e.s))*j-.5,m-q):h.rect(l,b-m,Math.min(3,e.s)*j-.5,m-q),h.fill()
					}
					)
				}
				else e.forEach(function(e,f){
					var l=a-2*j-j*(i-e.t)/36e5,m=5*g+(e.v-k)*((d?b-8*g:b)-5*g)/(max-k);
					h.beginPath(),h.fillStyle=aqiColor(e.v,"b",c),h.rect(l,b-m,Math.max(1,Math.min(3,e.s))*j-.5,m),h.fill()
				}
				);
				if(d)for(var o=0;
					40>o;
					o++){
					var p=a-1*j-j*(i-l+6*o*3600*1e3)/36e5;
					if(0>p)break;
					var r=9*g;
					h.beginPath(),h.font="bold "+r+"px sans-serif",h.fillStyle="#000000",h.textBaseline="top",h.textAlign="center";
					var m=new Date(l-6*o*3600*1e3).getHours();
					0==m&&(m=aqi18n.getDayName(new Date(l-6*o*3600*1e3)),g>1?h.font="lighter "+(r-g)+"px sans-serif":h.font="normal "+r+"px sans-serif"),h.lineWidth=1,h.strokeStyle="#ffffff",h.strokeText(m,p,0),h.fillText(m,p,0)
				}
				var s=document.createElement("img");
				return s.src=f.toDataURL(),s
			}
		;
		var isResizing=!1,resizeTimeout,imgLoaderDelay=[],postponneidx=0,currentsize=null,isMobileUA=function(a){
			return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))
		}
		(navigator.userAgent||navigator.vendor||window.opera),SCROLLMODE={
			PUSH:{
				value:"in"
			}
			,POP:{
				value:"out"
			}
			,REPLACE:{
				value:"replace"
			}

		}
			,waNavig=function(){
				this.count=1,this.list=["Main"],this.html5=!(!window.history||!history.pushState||void 0===history.state),navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&(this.html5=!1),this.html5&&window.addEventListener("popstate",function(a){
					waNav.back()
				}
				)
			}
		;
		waNavig.prototype.current=function(){
			return this.list[this.count-1]
		}
			,waNavig.prototype.previous=function(){
				return this.list[this.count-2]
			}
			,waNavig.prototype.replace=function(a){
				this.count>1&&(c=waNav.current(),this.list[this.count-1]=a,scrollPageCss("waPage"+a,"waPage"+c,SCROLLMODE.REPLACE))
			}
			,waNavig.prototype.push=function(a){
				closeOptionMenu(),c=waNav.current(),this.list[this.count++]=a,scrollPageCss("waPage"+a,"waPage"+c,SCROLLMODE.PUSH);
				try{
					this.html5&&history.pushState(null,null,null)
				}
				catch(b){

				}
				try{
					var d="onNavigateTo"+a;
					window[d]&&window[d]()
				}
				catch(b){

				}

			}
			,waNavig.prototype.pop=function(a){
				this.html5?window.history.back(-1):1==this.count?history.back():this.back()
			}
			,waNavig.prototype.back=function(){
				this.count>1&&(c=this.current(),this.count--,p=waNav.current(),scrollPageCss("waPage"+p,"waPage"+c,SCROLLMODE.POP))
			}
			,waNav=new waNavig;
		var absTime=0,isTouchEnabled=!1;
		isMobileUA||setInterval(function(){
			"undefined"!=typeof mapInitIsScriptLoaded&&mapInitIsScriptLoaded||window.location.reload()
		}
			,9e5),initButtons();
		var snapper=null;
		window.Modernizr=function(a,b,c){
			function d(a){
				n.cssText=a
			}
			function e(a,b){
				return typeof a===b
			}
			var f,g,h,i="2.7.1",j={

			}
				,k=b.documentElement,l="modernizr",m=b.createElement(l),n=m.style,o=({

				}
					.toString,{

					}
				),p=[],q=p.slice,r={

				}
				.hasOwnProperty;
			h=e(r,"undefined")||e(r.call,"undefined")?function(a,b){
				return b in a&&e(a.constructor.prototype[b],"undefined")
			}
				:function(a,b){
					return r.call(a,b)
				}
				,Function.prototype.bind||(Function.prototype.bind=function(a){
					var b=this;
					if("function"!=typeof b)throw new TypeError;
					var c=q.call(arguments,1),d=function(){
						if(this instanceof d){
							var e=function(){

							}
							;
							e.prototype=b.prototype;
							var f=new e,g=b.apply(f,c.concat(q.call(arguments)));
							return Object(g)===g?g:f
						}
						return b.apply(a,c.concat(q.call(arguments)))
					}
					;
					return d
				}
				),o.geolocation=function(){
					return"geolocation"in navigator
				}
			;
			for(var s in o)h(o,s)&&(g=s.toLowerCase(),j[g]=o[s](),p.push((j[g]?"":"no-")+g));
			return j.addTest=function(a,b){
				if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);
				else{
					if(a=a.toLowerCase(),j[a]!==c)return j;
					b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(k.className+=" "+(b?"":"no-")+a),j[a]=b
				}
				return j
			}
				,d(""),m=f=null,j._version=i,j
		}
		(this,this.document);
		var generators=[];

